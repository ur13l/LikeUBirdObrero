
<StackLayout class="background-blue" orientation="vertical">
  <StackLayout style="background:white" orientation="vertical" height="100%" *ngIf="messaging">
    <StackLayout class="background-blue" orientation="horizontal" width="100%" verticalAlignment="center" horizontalAlignment="center" height="10%">
      <StackLayout width="20%" verticalAlignment="center">
        <Image class="img-rounded" [src]="worker.image" stretch="aspectFill" height="50" width="50"></Image>
      </StackLayout>
      <StackLayout width="60%" horizontalAlignment="center" verticalAlignment="center">
        <Label class="white-text bold" [text]="worker.name"></Label>
      </StackLayout>
      <StackLayout width="20%" horizontalAlignment="right" verticalAlignment="center">
        <Image src="~/assets/img/cancel.png" height="20" width="20" (tap)="stopMessaging()"></Image>
      </StackLayout>
    </StackLayout>
    <StackLayout height="80%" verticalAlignment="bottom">
      <StackLayout col="0" row="6" orientation="horizontal" horizontalAlignment="right"> 
        <Label class="chat-message-sent" text="Buen día, ya me encuentro en camino" margin="10" textWrap="true" width=""></Label>
        <Image class="img-rounded" [src]="user.image" stretch="aspectFill" margin="10" height="50" width="50"></Image>
      </StackLayout>
      <StackLayout col="0" row="7" orientation="horizontal"> 
        <Image class="img-rounded" [src]="worker.image" stretch="aspectFill" margin="10" height="50" width="50"></Image>
        <Label class="chat-message-enter" text="Muchas gracias, ¿podría decirme en cuánto tiempo llega?" margin="10" textWrap="true"></Label>
      </StackLayout>
      <StackLayout col="0" row="6" orientation="horizontal" horizontalAlignment="right" *ngFor="let message of messages"> 
        <Label class="chat-message-sent" [text]="message" margin="10" textWrap="true" width=""></Label>
        <Image class="img-rounded" [src]="user.image" stretch="aspectFill" margin="10" height="50" width="50"></Image>
      </StackLayout>
    </StackLayout>
    <StackLayout height="10%" orientation="horizontal">
      <Image src="~/assets/img/photo-camera.png" height="30" width="30" marginRight="10"></Image>
      <TextField width="80%" [(ngModel)]="m"></TextField>
      <Image src="~/assets/img/send.png" height="50" width="50" (tap)="send()"></Image>
    </StackLayout>
  </StackLayout>
  <AbsoluteLayout [height]="heightmap">
    <GridLayout columns="*" rows="*" height="100%" width="100%">
      <MapView col="0" row="0" [latitude]="latitude" [longitude]="longitude" [zoom]="zoom" mapAnimationsEnabled="true" (mapReady)="onMapReady($event)" (markerSelect)="onMarkerSelect($event)" (cameraChanged)="onCameraChanged($event)"></MapView>
    </GridLayout>
    <StackLayout class="address-block" orientation="horizontal" width="90%">
      <StackLayout width="10%">
        <Image src="~/assets/img/back.png" (tap)="back()" width="20" height="20"></Image>
      </StackLayout>
      <StackLayout width="80%" horizontalAlignment="center" verticalAlignment="center">
        <Label [text]="address" textAlign="center"></Label>
      </StackLayout>
      <StackLayout width="10%" *ngIf="!addressChange">
        <Image src="~/assets/img/edit.png" (tap)="editAddress()" width="20" height="20"></Image>
      </StackLayout>
      <StackLayout width="10%" *ngIf="addressChange">
        <Image src="~/assets/img/checked.png" (tap)="cancelEditAddress()" width="20" height="20"></Image>
      </StackLayout>
    </StackLayout>
    <Image src="~/assets/img/marker.png" left="180" top="270" height="5%" *ngIf="addressChange"></Image>
  </AbsoluteLayout>
  <StackLayout height="15%" orientation="horizontal" padding="10" *ngIf="worker">
    <StackLayout width="20%" verticalAlignment="center">
      <Image class="img-rounded" [src]="worker.image" stretch="aspectFill" height="50" width="50"></Image>
    </StackLayout>
    <StackLayout width="40%" orientation="vertical">
      <Label class="white-text bold" [text]="worker.name"></Label>
      <Label class="secondary-text" *ngFor="let skill of worker?.skills" [text]="skill.name"></Label>
    </StackLayout>
    <StackLayout width="20%" orientation="horizontal">
      <Image src="~/assets/img/paper-plane.png" height="30" width="30" (tap)="startMessaging()"></Image>
    </StackLayout>
    <StackLayout width="20%" orientation="horizontal">       
      <Image src="~/assets/img/checked-white.png" height="30" width="30" (tap)="makeOrder()"></Image>
    </StackLayout>
  </StackLayout>
  <StackLayout height="10%" orientation="horizontal">
    <StackLayout width="20%" height="100%" (tap)="select(1)" verticalAlignment="center" horizontalAlignment="center" [class.selected]="serviceSelected == 1">
      <Image height="20" src="~/assets/img/faucet.png"></Image>
    </StackLayout>
    <StackLayout width="20%" height="100%" (tap)="select(2)" verticalAlignment="center" horizontalAlignment="center" [class.selected]="serviceSelected == 2">
      <Image height="20" src="~/assets/img/plug.png"></Image>
    </StackLayout>
    <StackLayout width="20%" height="100%" (tap)="select(3)" verticalAlignment="center" horizontalAlignment="center" [class.selected]="serviceSelected == 3">
      <Image height="20" src="~/assets/img/monitor.png"></Image>
    </StackLayout>
    <StackLayout width="20%" height="100%" (tap)="select(4)" verticalAlignment="center" horizontalAlignment="center" [class.selected]="serviceSelected == 4">
      <Image height="20" src="~/assets/img/paintbrush.png"></Image>
    </StackLayout>
    <StackLayout width="20%" height="100%" (tap)="select(5)" verticalAlignment="center" horizontalAlignment="center" [class.selected]="serviceSelected == 5">
      <Image height="20" src="~/assets/img/spray.png"></Image>
    </StackLayout>
  </StackLayout>
</StackLayout>